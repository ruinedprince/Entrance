"use client";

import React, { useState, useEffect } from "react";
import * as flubber from "flubber";

const blobPaths = [
  "M17.8,-37C24.4,-27.1,31.9,-24.9,45.6,-20.1C59.2,-15.2,79,-7.6,80,0.6C81,8.7,63.1,17.4,48,19.8C32.9,22.2,20.6,18.4,13.1,26.4C5.6,34.4,2.8,54.3,-5.8,64.3C-14.3,74.3,-28.7,74.4,-34.5,65.4C-40.3,56.3,-37.5,38.2,-45.6,25.8C-53.7,13.4,-72.6,6.7,-80.4,-4.5C-88.3,-15.7,-85,-31.5,-76.4,-42.9C-67.8,-54.4,-53.8,-61.7,-40.1,-67.5C-26.5,-73.3,-13.3,-77.8,-3.8,-71.2C5.6,-64.6,11.3,-46.9,17.8,-37Z",
  "M22.3,-36.9C31.7,-33.2,44.1,-32.9,53,-27.3C61.9,-21.7,67.3,-10.9,64.4,-1.7C61.4,7.5,50.1,14.9,44.7,26.5C39.2,38,39.6,53.7,33.1,56.5C26.7,59.4,13.3,49.5,0.2,49.1C-12.9,48.7,-25.7,57.8,-31.2,54.3C-36.7,50.9,-34.8,34.9,-31.6,23.8C-28.5,12.7,-24.1,6.3,-22,1.2C-20,-3.9,-20.2,-7.8,-18.5,-10.7C-16.9,-13.6,-13.4,-15.4,-10,-22.5C-6.6,-29.6,-3.3,-42.1,1.6,-44.8C6.4,-47.5,12.9,-40.5,22.3,-36.9Z",
  "M37.7,-64.3C43,-62.2,37.5,-40.3,41.8,-26.3C46,-12.3,60.1,-6.1,58.1,-1.1C56.2,3.9,38.2,7.8,34.2,22.2C30.2,36.6,40.1,61.6,36.7,75.6C33.3,89.7,16.6,92.9,1.3,90.6C-14,88.4,-28,80.6,-30.1,65.7C-32.2,50.9,-22.3,29,-18.7,16.9C-15,4.8,-17.6,2.4,-26.4,-5C-35.1,-12.5,-50,-24.9,-53.3,-36.6C-56.7,-48.3,-48.6,-59.3,-37.8,-58.2C-27,-57.1,-13.5,-44.1,1.3,-46.4C16.2,-48.7,32.4,-66.4,37.7,-64.3Z",
  "M12.8,-17.7C22.6,-16.5,40.7,-25.2,45.6,-23.9C50.5,-22.6,42.3,-11.3,35.3,-4C28.3,3.2,22.6,6.5,22.9,16.8C23.2,27.1,29.4,44.5,26.6,54C23.8,63.5,11.9,65.1,4.4,57.4C-3,49.7,-6,32.7,-17.4,28.1C-28.7,23.5,-48.5,31.5,-51.3,28.8C-54.1,26.2,-40.1,13.1,-30,5.8C-20,-1.6,-14,-3.1,-17.6,-16.8C-21.1,-30.4,-34.2,-56.2,-32.9,-62.2C-31.5,-68.3,-15.8,-54.8,-7.1,-42.4C1.5,-30.1,3,-19,12.8,-17.7Z",
  "M39.8,-70.2C48.7,-63.7,51.3,-47.4,56.8,-34C62.4,-20.7,71,-10.3,68.2,-1.6C65.4,7.1,51.2,14.2,44.1,24.9C37,35.6,37,49.8,30.8,48.6C24.7,47.4,12.3,30.7,-1.6,33.4C-15.4,36.1,-30.9,58.2,-38.7,60.4C-46.6,62.6,-46.9,44.9,-45.7,31.5C-44.5,18.1,-41.9,9.1,-36.4,3.2C-30.9,-2.7,-22.5,-5.4,-16.2,-6C-10,-6.6,-6,-5,-3.7,-15.4C-1.3,-25.7,-0.7,-47.9,7.4,-60.7C15.4,-73.4,30.8,-76.8,39.8,-70.2Z",
  "M14.9,-13.3C28.5,-18,54.9,-32.5,55.3,-31.9C55.8,-31.3,30.1,-15.7,22.9,-4.2C15.6,7.3,26.8,14.7,31.9,24.7C37,34.8,36,47.7,29.6,60.2C23.3,72.7,11.6,84.8,-2,88.3C-15.6,91.7,-31.3,86.5,-43.4,77.3C-55.5,68.2,-64.2,55.1,-69.4,41.6C-74.7,28,-76.6,14,-73.6,1.8C-70.5,-10.5,-62.4,-20.9,-54.3,-29.5C-46.1,-38.1,-37.9,-44.7,-28.8,-42.7C-19.8,-40.6,-9.9,-29.8,-4.6,-21.8C0.7,-13.8,1.3,-8.6,14.9,-13.3Z",
  "M36.9,-65.3C40.5,-61.8,31,-37.1,36.2,-22.7C41.3,-8.3,61.1,-4.1,68.2,4.1C75.2,12.3,69.6,24.6,57.5,27C45.4,29.3,26.7,21.6,16,21.3C5.4,21,2.7,28.2,-3.9,34.9C-10.5,41.7,-20.9,48,-21.4,42.4C-21.9,36.8,-12.4,19.2,-16.5,10.2C-20.6,1.1,-38.3,0.6,-43,-2.8C-47.8,-6.1,-39.7,-12.1,-30.9,-13.2C-22.2,-14.2,-12.9,-10.2,-7.7,-12.8C-2.4,-15.3,-1.2,-24.4,7.7,-37.7C16.6,-51.1,33.3,-68.8,36.9,-65.3Z",
  "M20.1,-44.3C21.5,-34.1,15,-19.5,13,-11.4C10.9,-3.2,13.4,-1.6,20.4,4C27.3,9.6,38.6,19.2,38.6,23.8C38.6,28.3,27.1,27.8,18.8,30.9C10.5,34.1,5.2,40.9,0.4,40.3C-4.5,39.6,-8.9,31.4,-14.3,26.5C-19.6,21.6,-25.8,20,-24,16.2C-22.2,12.3,-12.5,6.2,-19.9,-4.3C-27.4,-14.8,-52,-29.5,-54.9,-35.2C-57.7,-40.9,-38.7,-37.4,-25.9,-41.1C-13.1,-44.7,-6.5,-55.3,1.4,-57.8C9.4,-60.2,18.7,-54.4,20.1,-44.3Z",
];

const BlobComponent = () => {
    const [currentPath, setCurrentPath] = useState(blobPaths[0]);
    const [currentPathIndex, setCurrentPathIndex] = useState(0);

    const transitionTime = 10000; // Time for the transition in milliseconds
    const intervalTime = 10000; // Time between transitions in milliseconds

    useEffect(() => {
        const interval = setInterval(() => {
            const nextIndex = (currentPathIndex + 1) % blobPaths.length;
            const interpolator = flubber.interpolate(
                blobPaths[currentPathIndex],
                blobPaths[nextIndex]
            );

            let frame = 0;
            const totalFrames = transitionTime / (1000 / 60); // Calculate frames based on transition time
            const easeInOut = (t: number) =>
                t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t; // EaseInOut function
            const animate = () => {
                frame++;
                if (frame <= totalFrames) {
                    const progress = easeInOut(frame / totalFrames);
                    setCurrentPath(interpolator(progress));
                    requestAnimationFrame(animate);
                } else {
                    setCurrentPathIndex(nextIndex);
                }
            };

            animate();
        }, intervalTime);

        return () => clearInterval(interval);
    }, [currentPathIndex]);

    return (
        <div className="absolute flex justify-center items-center w-full h-full blur-[500px] opacity-60">
            <svg viewBox="-125 -125 250 250">
                <defs>
                    <linearGradient id="grad1" x1="0%" x2="100%" y1="0%" y2="0%">
                        <stop offset="0%" stopColor="#8A35CE" />
                        <stop offset="100%" stopColor="#21CF63" />
                    </linearGradient>
                </defs>
                <path fill="url(#grad1)" d={currentPath} />
            </svg>
        </div>
    );
};

export default BlobComponent;
